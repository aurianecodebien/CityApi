apiVersion: postgresql.cnpg.io/v1
kind: Database
metadata:
  name: city-api-prod-db
  labels:
    app: city-api-app
    environment: prod
spec:
  databaseReclaimPolicy: retain
  name: city_api-prod-pg
  cluster:
    name: city-api-pg
  owner: city_api
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: cnpg-manager-role
  namespace: cityapi
rules:
  - apiGroups: [""]
    resources: ["configmaps"]
    verbs: ["get", "list", "watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: cnpg-manager-rolebinding
  namespace: cityapi
subjects:
  - kind: ServiceAccount
    name: cnpg-manager
    namespace: cityapi
roleRef:
  kind: Role
  name: cnpg-manager-role
  apiGroup: rbac.authorization.k8s.io
